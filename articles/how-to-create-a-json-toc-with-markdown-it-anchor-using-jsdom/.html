<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <meta name="theme-color" content="#333333" />
    <link rel="manifest" href="/manifest.json" crossorigin="use-credentials" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta http-equiv="content-security-policy" content=""><title>How to create a JSON table of contents with markdown-it and markdown-it-anchor - Angel Blanco&#39;s blog</title><meta name="description" content="Steps by step guide parse your markdown&#39;s HTML at compile stage using node and jsdom with full github repository." data-svelte="svelte-aky1d0"><meta property="og:url" content="https://angelblanco.dev/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/" data-svelte="svelte-aky1d0"><meta property="og:title" content="How to create a JSON table of contents with markdown-it and markdown-it-anchor" data-svelte="svelte-aky1d0"><meta property="og:description" content="Steps by step guide parse your markdown&#39;s HTML at compile stage using node and jsdom with full github repository." data-svelte="svelte-aky1d0"><meta property="og:image" content="https://angelblanco.dev/images/share-default.png" data-svelte="svelte-aky1d0"><meta property="og:image:width" content="1200" data-svelte="svelte-aky1d0"><meta property="og:image:height" content="630" data-svelte="svelte-aky1d0"><meta property="og:locale" content="en_US" data-svelte="svelte-aky1d0"><meta property="og:author" content="ﾃ］gel Blanco" data-svelte="svelte-aky1d0"><meta name="twitter:title" content="How to create a JSON table of contents with markdown-it and markdown-it-anchor" data-svelte="svelte-aky1d0"><meta name="twitter:description" content="Steps by step guide parse your markdown&#39;s HTML at compile stage using node and jsdom with full github repository." data-svelte="svelte-aky1d0"><meta name="twitter:card" content="summary_large_image" data-svelte="svelte-aky1d0"><meta name="twitter:site" content="@angelblancodev" data-svelte="svelte-aky1d0"><meta name="twitter:creator" content="@angelblancodev" data-svelte="svelte-aky1d0"><meta name="twitter:image" content="https://angelblanco.dev/images/share-default.png" data-svelte="svelte-aky1d0">
	<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-5c496c17.css">
	<link rel="stylesheet" href="/_app/assets/pages/articles/_slug_.svelte-39d0f134.css">
	<link rel="stylesheet" href="/_app/assets/TinyLetterSubscribeForm.svelte_svelte_type_style_lang-9e0ab98b.css">
	<link rel="modulepreload" href="/_app/start-f8140ddd.js">
	<link rel="modulepreload" href="/_app/chunks/vendor-54c6ab91.js">
	<link rel="modulepreload" href="/_app/pages/__layout.svelte-97c00a7f.js">
	<link rel="modulepreload" href="/_app/chunks/utils-123120c2.js">
	<link rel="modulepreload" href="/_app/chunks/canonical-fdacf4d6.js">
	<link rel="modulepreload" href="/_app/pages/articles/__layout.svelte-e94d3e2a.js">
	<link rel="modulepreload" href="/_app/pages/articles/_slug_.svelte-5a52e418.js">
	<link rel="modulepreload" href="/_app/chunks/Content-2ed3ba46.js">
	<link rel="modulepreload" href="/_app/chunks/Head-46f166e7.js">
	<link rel="modulepreload" href="/_app/chunks/meta-ebf74df4.js">
	<link rel="modulepreload" href="/_app/chunks/Tags-89f21549.js">
				<script>
		if ('serviceWorker' in navigator) {
			navigator.serviceWorker.register('/service-worker.js');
		}
	</script>
  </head>
  <body>
    



<nav class="navbar container is-hidden-print" aria-label="main navigation"><div class="navbar-brand"><a class="navbar-item svelte-19lyduh" href="/">
      <img alt="logo" src="/logo.png" width="160" height="24"></a>

    <span role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample"><span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span></span></div>

  <div class="navbar-menu svelte-19lyduh"><div class="navbar-end"><a rel="prefetch" class="navbar-item is-primary is-active svelte-19lyduh" href="/articles/"><span class="icon is-hidden-desktop"><i class="fas fa-book fa-lg"></i></span>
        <span>Articles</span></a>
      <a rel="prefecth" class="navbar-item is-primary  svelte-19lyduh" href="/about/"><span class="icon is-hidden-desktop"><i class="fas fa-user fa-lg"></i></span>
        <span>About</span></a>

      <a href="https://github.com/angelblanco/angelblanco.dev" target="__blank" class="navbar-item svelte-19lyduh" aria-label="My Github page"><span class="icon"><i class="fab fa-github-alt fa-lg"></i></span>

        <span class="is-hidden-desktop">Github</span></a></div></div>
</nav>


<div class="back-to-top is-hidden-print svelte-1d29tie hidden"><span class="icon is-large"><i class="fas fa-chevron-up fa-2x svelte-1d29tie"></i></span>
</div>

<main class="blog"><div class="container">



<section class="section reading-width pb-0"><article class="media"><figure class="media-left"><a href="/about/" rel="prefecth" class="image is-64x64" aria-label="Abot the author"><img class="is-rounded" src="/images/me-128x128.jpeg" alt="user" width="128" height="128"></a></figure>

  <div class="media-content"><div class="media-title-container svelte-1d83kht"><span>ﾃ］gel Blanco </span>

      <span class="date-subtitle has-text-grey-light" aria-label="Written at 2020-09-18. Estimated 5 min read">2020-09-18 ﾂｷ 5 min read</span></div>

    <div class="tags " aria-hidden="true"><a rel="prefetch" href="/tag/js/" class="tag is-light is-medium js" aria-hidden="true">Javascript</a><a rel="prefetch" href="/tag/node/" class="tag is-light is-medium node" aria-hidden="true">Node JS</a><a rel="prefetch" href="/tag/github/" class="tag is-light is-medium github" aria-hidden="true">Articles with Github code</a></div></div>

  <div class="media-right"><a href="https://twitter.com/angelblancodev/status/1311016921006059527" target="__blank" class="tweet-link icon is-large" aria-label="Twitter feed"><i class="fab fa-twitter fa-2x"></i></a></div>
</article></section>



<div class="nprogress svelte-1cv4mhg hidden" style="transition: opacity 300ms linear"><div class="bar svelte-1cv4mhg" style="margin-left: -100%;transition: all 300ms linear"></div>
</div>


<div class="article-sidebar-overlay svelte-1uubpsp hidden"><div class="section reading-width svelte-1uubpsp"><div class="sidebar svelte-1uubpsp"><div class="social-icons has-text-align-left svelte-1uubpsp"><div class="is-clearfix"><a href="https://twitter.com/intent/tweet?url=https://angelblanco.dev/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/&amp;text=How%20to%20create%20a%20JSON%20table%20of%20contents%20with%20markdown-it%20and%20markdown-it-anchor&amp;via=angelblancodev" target="__blank" class="button is-small svelte-1uubpsp"><span class="icon is-small svelte-1uubpsp"><i class="fab fa-twitter svelte-1uubpsp"></i></span>
              <span>Share on Twitter</span></a>
          </div><div class="is-clearfix"><a href="https://wwww.facebook.com/sharer.php?u=https://angelblanco.dev/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/&amp;t=How%20to%20create%20a%20JSON%20table%20of%20contents%20with%20markdown-it%20and%20markdown-it-anchor" target="__blank" class="button is-small svelte-1uubpsp"><span class="icon is-small svelte-1uubpsp"><i class="fab fa-facebook svelte-1uubpsp"></i></span>
              <span>Share on Facebook</span></a>
          </div><div class="is-clearfix"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://angelblanco.dev/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/" target="__blank" class="button is-small svelte-1uubpsp"><span class="icon is-small svelte-1uubpsp"><i class="fab fa-linkedin-in svelte-1uubpsp"></i></span>
              <span>Share on Linkedin</span></a>
          </div>

        <div class="is-clearfix"><button class="button is-small svelte-1uubpsp"><span class="icon is-small svelte-1uubpsp"><i class="fas fa-comments svelte-1uubpsp"></i></span>
            <span>Go Comments</span></button></div>

        <div class="is-clearfix"><button class="button is-small  svelte-1uubpsp"><span class="icon is-small svelte-1uubpsp"><i class="fas fa-share-alt svelte-1uubpsp"></i></span>
            <span class="svelte-1uubpsp">Share to clipboard</span></button></div></div></div></div>
</div>

<section class="section reading-width"><h1 class="title is-1">How to create a JSON table of contents with markdown-it and markdown-it-anchor</h1>

  <div class="content is-medium blog ">
    <!-- HTML_TAG_START --><p>There are some plugins to create a table of content using markdown-it, but sometimes you want to create a custom component for rendering your TOC.</p>
<p>Here a simple example on how to get the table of content's tree with vanilla javascript without writing any markdown-it plugin.</p>
<pre class="terminal gnome-terminal-image-container"><div class="bar"><div class="btn"></div><div class="bar-title">bash</div></div><div class="body"><div class="image"><img alt="o" src="https://raw.githubusercontent.com/angelblanco/demo-markdown-it-anchor-toc-jsdom/master/demo.gif"></div></div></pre><!-- HTML_TAG_END -->
  </div>

  <div class="box toc svelte-nxtey2"><div class="menu"><p class="menu-label has-text-info svelte-nxtey2">On this article</p>
      <ul class="menu-list"><li><a href="#basic-markdown-it-setup" class="svelte-nxtey2">Basic markdown it setup</a>

            
          </li><li><a href="#plain-table-of-content" class="svelte-nxtey2">Plain table of content</a>

            
          </li><li><a href="#tree-table-of-content" class="svelte-nxtey2">Tree table of content</a>

            
          </li><li><a href="#create-the-tables-of-content-on-the-server-side-with-jsdom" class="svelte-nxtey2">Create the tables of content on the server-side with jsdom</a>

            
          </li><li><a href="#conclusion" class="svelte-nxtey2">Conclusion</a>

            
          </li></ul></div></div>

  <div class="content is-medium blog articleBody">
    <!-- HTML_TAG_START --><h2 id="basic-markdown-it-setup" tabindex="-1"><a class="header-anchor" href="#basic-markdown-it-setup">Basic markdown it setup</a></h2>
<blockquote>
<p>If you want to skip this process and run the demo on your personal computer you can clone the demo repository on Github</p>
<div class="github-link-container"><a href="https://github.com/angelblanco/demo-markdown-it-anchor-toc-jsdom" target="__blank" class="button is-medium"><span class="icon"><i class="fab fa-github"></i></span><span>Clone the demo of this article on Github</span></a></div></blockquote>
<p>On your javascript application, we want to install some dependencies first.</p>
<pre class="terminal">
  <div class="bar bar-language-bash">
    <div class="btn"></div>
    <div class="bar-title">bash</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-bash"><code><span class="hl--token hl--function">yarn</span> <span class="hl--token hl--function">add</span> --dev markdown-it markdown-it-anchor
</code></pre></div>
  </pre>
<p>Now let's convert some simple markdown to Html:</p>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--comment">// demo.js</span>
<span class="hl--token hl--keyword">const</span> <span class="hl--token hl--maybe-class-name">MarkdownIt</span> <span class="hl--token hl--operator">=</span> <span class="hl--token hl--function">require</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--string">'markdown-it'</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

<span class="hl--token hl--keyword">const</span> md <span class="hl--token hl--operator">=</span> <span class="hl--token hl--keyword">new</span> <span class="hl--token hl--class-name">MarkdownIt</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">use</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--function">require</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--string">'markdown-it-anchor'</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

<span class="hl--token hl--keyword">const</span> markdownText <span class="hl--token hl--operator">=</span> <span class="hl--token hl--template-string"><span class="hl--token hl--template-punctuation hl--string">`</span><span class="hl--token hl--string">
# First header
Some content

## Second-level header
More content
### Third level header
## Another second-level header
</span><span class="hl--token hl--template-punctuation hl--string">`</span></span><span class="hl--token hl--punctuation">;</span>

<span class="hl--token hl--keyword">const</span> html <span class="hl--token hl--operator">=</span> md<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">render</span><span class="hl--token hl--punctuation">(</span>markdownText<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

<span class="hl--token hl--console hl--class-name">console</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">log</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">{</span> html <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
</code></pre></div>
  </pre>
<h2 id="plain-table-of-content" tabindex="-1"><a class="header-anchor" href="#plain-table-of-content">Plain table of content</a></h2>
<p>The first approach will be to create a plain TOC, that returns a one level array with the title, the anchor, and the associated level. Using this type of TOC could give you a really clear component, avoiding the extra complexity of recursion.</p>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--keyword">function</span> <span class="hl--token hl--function">createPlainToc</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--parameter">domElement</span><span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--punctuation">{</span>
  <span class="hl--token hl--keyword">const</span> headers <span class="hl--token hl--operator">=</span> <span class="hl--token hl--known-class-name hl--class-name">Array</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--keyword hl--module">from</span><span class="hl--token hl--punctuation">(</span>
    domElement<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">querySelectorAll</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--string">'h1, h2, h3, h4, h5, h6, h7'</span><span class="hl--token hl--punctuation">)</span>
  <span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

  <span class="hl--token hl--comment">// This will create a plain array with the level, the anchor and the header title</span>
  <span class="hl--token hl--keyword hl--control-flow">return</span> headers<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">map</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--parameter">header</span><span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--arrow hl--operator">=></span> <span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">{</span>
    <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--function">parseInt</span><span class="hl--token hl--punctuation">(</span>header<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">tagName</span><span class="hl--token hl--punctuation">[</span><span class="hl--token hl--number">1</span><span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">,</span> <span class="hl--token hl--number">10</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> header<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">textContent</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#'</span> <span class="hl--token hl--operator">+</span> header<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">getAttribute</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--string">'id'</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">,</span>
  <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
<span class="hl--token hl--punctuation">}</span>
</code></pre></div>
  </pre>
<p>Using the above markdown text, it will return us the following output:</p>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--punctuation">[</span>
  <span class="hl--token hl--punctuation">{</span> <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">1</span><span class="hl--token hl--punctuation">,</span> <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'First header'</span><span class="hl--token hl--punctuation">,</span> <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#first-header'</span> <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
  <span class="hl--token hl--punctuation">{</span> <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">2</span><span class="hl--token hl--punctuation">,</span> <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'Second level header'</span><span class="hl--token hl--punctuation">,</span> <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#second-level-header'</span> <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
  <span class="hl--token hl--punctuation">{</span> <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">3</span><span class="hl--token hl--punctuation">,</span> <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'Third level header'</span><span class="hl--token hl--punctuation">,</span> <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#third-level-header'</span> <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
  <span class="hl--token hl--punctuation">{</span>
    <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">2</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'Another second level header'</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#another-second-level-header'</span><span class="hl--token hl--punctuation">,</span>
  <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
<span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">;</span>
</code></pre></div>
  </pre>
<blockquote>
<p>Alternatively you can test the above function with this page itself. You can copy the function and run
the following code on the browser's console</p>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--console hl--class-name">console</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">log</span><span class="hl--token hl--punctuation">(</span>
  <span class="hl--token hl--known-class-name hl--class-name">JSON</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">stringify</span><span class="hl--token hl--punctuation">(</span>
    <span class="hl--token hl--function">createPlainToc</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--dom hl--variable">window</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">document</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">querySelector</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--string">'.articleBody'</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">)</span>
  <span class="hl--token hl--punctuation">)</span>
<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
</code></pre></div>
  </pre>
</blockquote>
<h2 id="tree-table-of-content" tabindex="-1"><a class="header-anchor" href="#tree-table-of-content">Tree table of content</a></h2>
<p>Most of the time we will be interested in creating a tree representation of the data.
In this way, we can create a recursive component that runs through the tree. We can reuse our previous function and build the data using a stack and tacking advantage of object references in Javascript. We must perform two validations:</p>
<ol>
<li>We force all root nodes to have the same level, but not a minimum one.</li>
<li>We force all children nodes to have the parent's level + 1.</li>
</ol>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--keyword">function</span> <span class="hl--token hl--function">createTreeToc</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--parameter">domElement<span class="hl--token hl--punctuation">,</span> throwOnNotTree <span class="hl--token hl--operator">=</span> <span class="hl--token hl--boolean">true</span></span><span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--punctuation">{</span>
  <span class="hl--token hl--keyword">const</span> treeItems <span class="hl--token hl--operator">=</span> <span class="hl--token hl--function">createPlainToc</span><span class="hl--token hl--punctuation">(</span>domElement<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">map</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--parameter">item</span><span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--arrow hl--operator">=></span> <span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">{</span>
    <span class="hl--token hl--spread hl--operator">...</span>item<span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">children</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--punctuation">[</span><span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">,</span>
  <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

  <span class="hl--token hl--keyword">const</span> tree <span class="hl--token hl--operator">=</span> <span class="hl--token hl--punctuation">[</span><span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">;</span>
  <span class="hl--token hl--keyword">const</span> stack <span class="hl--token hl--operator">=</span> <span class="hl--token hl--punctuation">[</span><span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">;</span>
  treeItems<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">forEach</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--parameter">item</span><span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--arrow hl--operator">=></span> <span class="hl--token hl--punctuation">{</span>
    <span class="hl--token hl--keyword">let</span> parentItem <span class="hl--token hl--operator">=</span> <span class="hl--token hl--keyword hl--null hl--nil">null</span><span class="hl--token hl--punctuation">;</span>
    <span class="hl--token hl--keyword hl--control-flow">do</span> <span class="hl--token hl--punctuation">{</span>
      parentItem <span class="hl--token hl--operator">=</span> stack<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">pop</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
    <span class="hl--token hl--punctuation">}</span> <span class="hl--token hl--keyword hl--control-flow">while</span> <span class="hl--token hl--punctuation">(</span>parentItem <span class="hl--token hl--operator">&amp;&amp;</span> parentItem<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">level</span> <span class="hl--token hl--operator">>=</span> item<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">level</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

    <span class="hl--token hl--keyword hl--control-flow">if</span> <span class="hl--token hl--punctuation">(</span><span class="hl--token hl--operator">!</span>parentItem<span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--punctuation">{</span>
      <span class="hl--token hl--comment">// All nodes in tree[] must have the same level.</span>
      <span class="hl--token hl--keyword">const</span> prevTreeItem <span class="hl--token hl--operator">=</span> tree<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">pop</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
      <span class="hl--token hl--keyword hl--control-flow">if</span> <span class="hl--token hl--punctuation">(</span>prevTreeItem<span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--punctuation">{</span>
        <span class="hl--token hl--keyword hl--control-flow">if</span> <span class="hl--token hl--punctuation">(</span>throwOnNotTree <span class="hl--token hl--operator">&amp;&amp;</span> item<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">level</span> <span class="hl--token hl--operator">!==</span> prevTreeItem<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">level</span><span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--punctuation">{</span>
          <span class="hl--token hl--keyword hl--control-flow">throw</span> <span class="hl--token hl--keyword">new</span> <span class="hl--token hl--class-name">Error</span><span class="hl--token hl--punctuation">(</span>
            <span class="hl--token hl--template-string"><span class="hl--token hl--template-punctuation hl--string">`</span><span class="hl--token hl--string">Root titles dont have same level on: "</span><span class="hl--token hl--interpolation"><span class="hl--token hl--interpolation-punctuation hl--punctuation">${</span>item<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">title</span><span class="hl--token hl--interpolation-punctuation hl--punctuation">}</span></span><span class="hl--token hl--string">"</span><span class="hl--token hl--template-punctuation hl--string">`</span></span>
          <span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
        <span class="hl--token hl--punctuation">}</span>

        tree<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">push</span><span class="hl--token hl--punctuation">(</span>prevTreeItem<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
      <span class="hl--token hl--punctuation">}</span>

      tree<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">push</span><span class="hl--token hl--punctuation">(</span>item<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
      stack<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">push</span><span class="hl--token hl--punctuation">(</span>item<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
    <span class="hl--token hl--punctuation">}</span> <span class="hl--token hl--keyword hl--control-flow">else</span> <span class="hl--token hl--punctuation">{</span>
      <span class="hl--token hl--keyword hl--control-flow">if</span> <span class="hl--token hl--punctuation">(</span>throwOnNotTree <span class="hl--token hl--operator">&amp;&amp;</span> parentItem<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">level</span> <span class="hl--token hl--operator">!==</span> item<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">level</span> <span class="hl--token hl--operator">-</span> <span class="hl--token hl--number">1</span><span class="hl--token hl--punctuation">)</span> <span class="hl--token hl--punctuation">{</span>
        <span class="hl--token hl--comment">// All nodes in tree[] must have the same level.</span>
        <span class="hl--token hl--keyword hl--control-flow">throw</span> <span class="hl--token hl--keyword">new</span> <span class="hl--token hl--class-name">Error</span><span class="hl--token hl--punctuation">(</span>
          <span class="hl--token hl--template-string"><span class="hl--token hl--template-punctuation hl--string">`</span><span class="hl--token hl--string">The title "</span><span class="hl--token hl--interpolation"><span class="hl--token hl--interpolation-punctuation hl--punctuation">${</span>item<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">title</span><span class="hl--token hl--interpolation-punctuation hl--punctuation">}</span></span><span class="hl--token hl--string">" is not a direct children of its parent</span><span class="hl--token hl--template-punctuation hl--string">`</span></span>
        <span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
      <span class="hl--token hl--punctuation">}</span>

      stack<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">push</span><span class="hl--token hl--punctuation">(</span>parentItem<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
      stack<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">push</span><span class="hl--token hl--punctuation">(</span>item<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
      parentItem<span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">children</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">push</span><span class="hl--token hl--punctuation">(</span>item<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
    <span class="hl--token hl--punctuation">}</span>
  <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

  <span class="hl--token hl--keyword hl--control-flow">return</span> tree<span class="hl--token hl--punctuation">;</span>
<span class="hl--token hl--punctuation">}</span>
</code></pre></div>
  </pre>
<p>Using the previous markdown we will have a well-defined tree for each top-level header and their associated children.</p>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--punctuation">[</span>
  <span class="hl--token hl--punctuation">{</span>
    <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">1</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'First header'</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#first-header'</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--literal-property hl--property">children</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--punctuation">[</span>
      <span class="hl--token hl--punctuation">{</span>
        <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">2</span><span class="hl--token hl--punctuation">,</span>
        <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'Second level header'</span><span class="hl--token hl--punctuation">,</span>
        <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#second-level-header'</span><span class="hl--token hl--punctuation">,</span>
        <span class="hl--token hl--literal-property hl--property">children</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--punctuation">[</span>
          <span class="hl--token hl--punctuation">{</span>
            <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">3</span><span class="hl--token hl--punctuation">,</span>
            <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'Third level header'</span><span class="hl--token hl--punctuation">,</span>
            <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#third-level-header'</span><span class="hl--token hl--punctuation">,</span>
            <span class="hl--token hl--literal-property hl--property">children</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--punctuation">[</span><span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">,</span>
          <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
        <span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">,</span>
      <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
      <span class="hl--token hl--punctuation">{</span>
        <span class="hl--token hl--literal-property hl--property">level</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--number">2</span><span class="hl--token hl--punctuation">,</span>
        <span class="hl--token hl--literal-property hl--property">title</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'Another second level header'</span><span class="hl--token hl--punctuation">,</span>
        <span class="hl--token hl--literal-property hl--property">anchor</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--string">'#another-second-level-header'</span><span class="hl--token hl--punctuation">,</span>
        <span class="hl--token hl--literal-property hl--property">children</span><span class="hl--token hl--operator">:</span> <span class="hl--token hl--punctuation">[</span><span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">,</span>
      <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
    <span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">,</span>
  <span class="hl--token hl--punctuation">}</span><span class="hl--token hl--punctuation">,</span>
<span class="hl--token hl--punctuation">]</span><span class="hl--token hl--punctuation">;</span>
</code></pre></div>
  </pre>
<p>Of course opening the dev tools you can paste the previous functions, an test it with this page!</p>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--console hl--class-name">console</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">log</span><span class="hl--token hl--punctuation">(</span>
  <span class="hl--token hl--known-class-name hl--class-name">JSON</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">stringify</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--function">createTreeToc</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--dom hl--variable">window</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">document</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">querySelector</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--string">'.articleBody'</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">)</span>
<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
</code></pre></div>
  </pre>
<h2 id="create-the-tables-of-content-on-the-server-side-with-jsdom" tabindex="-1"><a class="header-anchor" href="#create-the-tables-of-content-on-the-server-side-with-jsdom">Create the tables of content on the server-side with jsdom</a></h2>
<p>If you want to create the TOC on your node server or at the moment of compiling your markdown files, we can reuse our functions by installing <a href="https://github.com/jsdom/jsdom" target="_blank">jsdom</a>.</p>
<pre class="terminal">
  <div class="bar bar-language-bash">
    <div class="btn"></div>
    <div class="bar-title">bash</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-bash"><code><span class="hl--token hl--function">yarn</span> <span class="hl--token hl--function">add</span> --dev jsdom
</code></pre></div>
  </pre>
<p>As the Html will be the hole markdown file we can create the table of content for the whole <code>window.document</code>.</p>
<pre class="terminal">
  <div class="bar bar-language-javascript">
    <div class="btn"></div>
    <div class="bar-title">javascript</div>
    <div><button class="button copy is-small is-pulled-right">Copy</button></div>  
  </div>
  <div class="body"><pre class="language-javascript"><code><span class="hl--token hl--comment">// Asuming that html is the rendered markdown with html and nothing else.</span>
<span class="hl--token hl--keyword">const</span> domElement <span class="hl--token hl--operator">=</span> <span class="hl--token hl--keyword">new</span> <span class="hl--token hl--class-name">jsdom<span class="hl--token hl--punctuation">.</span>JSDOM</span><span class="hl--token hl--punctuation">(</span>html<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">window</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--property-access">document</span><span class="hl--token hl--punctuation">;</span>

<span class="hl--token hl--keyword">const</span> toc <span class="hl--token hl--operator">=</span> <span class="hl--token hl--function">createTreeToc</span><span class="hl--token hl--punctuation">(</span>domElement<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>

<span class="hl--token hl--console hl--class-name">console</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">log</span><span class="hl--token hl--punctuation">(</span><span class="hl--token hl--known-class-name hl--class-name">JSON</span><span class="hl--token hl--punctuation">.</span><span class="hl--token hl--method hl--function hl--property-access">stringify</span><span class="hl--token hl--punctuation">(</span>toc<span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">)</span><span class="hl--token hl--punctuation">;</span>
</code></pre></div>
  </pre>
<p>Using this last approach its how I set up a simple demo on Github.</p>
<div class="github-link-container"><a href="https://github.com/angelblanco/demo-markdown-it-anchor-toc-jsdom" target="__blank" class="button is-medium"><span class="icon"><i class="fab fa-github"></i></span><span>Clone the demo of this article on Github</span></a></div><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion">Conclusion</a></h2>
<p>Using <code>jsdom</code> to parse the whole HTML file to get the table of content might look like an overhead. However, doing this stuff at
your javascript compile stage will get you the fastest loading times for your web because it could be server-side rendered. On the other hand,
if you parse your TOC in the browser you could access all the DOM elements on the web and not only the markdown ones.</p>
<p>Thank you very much for your time. Hope to see you again 泅</p>
<!-- HTML_TAG_END -->
  </div>

  <div class="is-hidden-print"><hr>

  <div><div class="has-text-centered"><div><span class="has-text-weight-bold has-text-centered has-text-grey-dark">Share
        </span></div>
      <div class="icons-container svelte-ralcnf"><a href="https://twitter.com/intent/tweet?url=https://angelblanco.dev/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/&amp;text=How%20to%20create%20a%20JSON%20table%20of%20contents%20with%20markdown-it%20and%20markdown-it-anchor&amp;via=angelblancodev" target="__blank" class="icon is-large" aria-label="Share on Twitter"><i class="fab fa-2x fa-twitter svelte-ralcnf"></i>
          </a><a href="https://wwww.facebook.com/sharer.php?u=https://angelblanco.dev/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/&amp;t=How%20to%20create%20a%20JSON%20table%20of%20contents%20with%20markdown-it%20and%20markdown-it-anchor" target="__blank" class="icon is-large" aria-label="Share on Facebook"><i class="fab fa-2x fa-facebook svelte-ralcnf"></i>
          </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://angelblanco.dev/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/" target="__blank" class="icon is-large" aria-label="Share on Linkedin"><i class="fab fa-2x fa-linkedin-in svelte-ralcnf"></i>
          </a></div></div></div>

  
</div></section>

<section class="section reading-width is-hidden-print" id="comments"><h3 class="title is-3">Comments</h3>

  <div id="disqus_thread"></div></section>

<div class="afterArticleContainer svelte-1xs3w5z"></div>

</div></main>

<footer class="footer info svelte-1vimzui" aria-hidden="true"><hr class="footerRule is-hidden-print svelte-1vimzui">

  <div class="has-text-centered"><p class="has-text-grey-light is-family-monospace svelte-1vimzui">Personal website of <a href="/about/" class="has-text-grey-dark svelte-1vimzui">ﾃ］gel Blanco</a></p>

    <p class="footer-github is-hidden-print svelte-1vimzui"><a href="https://github.com/angelblanco/angelblanco.dev" class="button svelte-1vimzui" target="__blank"><span class="icon"><span class="fab fa-github"></span></span>

        <span>Developed by ﾃ］gel Blanco hosted on Github</span></a></p>

    <div class="libraries-box is-m-auto is-hidden-print svelte-1vimzui"><div class="box"><p class="has-text-grey-light is-family-monospace svelte-1vimzui">This project <i class="fas fa-heart svelte-1vimzui"></i> this libraries
        </p>

        <div class="field is-grouped is-grouped-multiline is-m-auto justify-center"><div class="control"><div class="tags has-addons"><span class="tag is-dark">framework</span>
                <a href="https://kit.svelte.dev/" class="tag is-light svelte-1vimzui">svelte-kit</a></div>
            </div><div class="control"><div class="tags has-addons"><span class="tag is-dark">css</span>
                <a href="https://bulma.io/" class="tag is-light svelte-1vimzui">bulma</a></div>
            </div><div class="control"><div class="tags has-addons"><span class="tag is-dark">js</span>
                <a href="https://svelte.dev/" class="tag is-light svelte-1vimzui">svelte</a></div>
            </div><div class="control"><div class="tags has-addons"><span class="tag is-dark">bundler</span>
                <a href="https://rollupjs.org/" class="tag is-light svelte-1vimzui">rollup</a></div>
            </div><div class="control"><div class="tags has-addons"><span class="tag is-dark">md</span>
                <a href="https://github.com/markdown-it/markdown-it" class="tag is-light svelte-1vimzui">markdown-it</a></div>
            </div></div>

        <p class="has-text-grey-light is-family-monospace is-size-7 svelte-1vimzui">And all of <a class="has-decoration-underline has-text-grey-dark svelte-1vimzui" href="/libraries/" rel="preload">these...</a></p></div></div></div>
</footer>


		<script type="module" data-hydrate="7ub611">
		import { start } from "/_app/start-f8140ddd.js";
		start({
			target: document.querySelector('[data-hydrate="7ub611"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "ignore",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/_app/pages/__layout.svelte-97c00a7f.js"),
						import("/_app/pages/articles/__layout.svelte-e94d3e2a.js"),
						import("/_app/pages/articles/_slug_.svelte-5a52e418.js")
				],
				params: {slug:"how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom"}
			}
		});
	</script><script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/api/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"id\":2,\"type\":\"article\",\"tweet\":\"1311016921006059527\",\"slug\":\"how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom\",\"url\":\"/articles/how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom/\",\"title\":\"How to create a JSON table of contents with markdown-it and markdown-it-anchor\",\"intro\":\"\u003Cp>There are some plugins to create a table of content using markdown-it, but sometimes you want to create a custom component for rendering your TOC.\u003C/p>\\n\u003Cp>Here a simple example on how to get the table of content's tree with vanilla javascript without writing any markdown-it plugin.\u003C/p>\\n\u003Cpre class=\\\"terminal gnome-terminal-image-container\\\">\u003Cdiv class=\\\"bar\\\">\u003Cdiv class=\\\"btn\\\">\u003C/div>\u003Cdiv class=\\\"bar-title\\\">bash\u003C/div>\u003C/div>\u003Cdiv class=\\\"body\\\">\u003Cdiv class=\\\"image\\\">\u003Cimg alt=\\\"o\\\" src=\\\"https://raw.githubusercontent.com/angelblanco/demo-markdown-it-anchor-toc-jsdom/master/demo.gif\\\">\u003C/div>\u003C/div>\u003C/pre>\",\"description\":\"Steps by step guide parse your markdown's HTML at compile stage using node and jsdom with full github repository.\",\"tags\":[\"js\",\"node\",\"github\"],\"date\":\"September 18, 2020\",\"readingTimeText\":\"5 min read\",\"readingTimeMinutes\":4.13,\"words\":826,\"note\":false,\"shortLink\":\"/go/YS0y\",\"toc\":{\"tree\":[{\"level\":2,\"title\":\"Basic markdown it setup\",\"anchor\":\"#basic-markdown-it-setup\",\"children\":[]},{\"level\":2,\"title\":\"Plain table of content\",\"anchor\":\"#plain-table-of-content\",\"children\":[]},{\"level\":2,\"title\":\"Tree table of content\",\"anchor\":\"#tree-table-of-content\",\"children\":[]},{\"level\":2,\"title\":\"Create the tables of content on the server-side with jsdom\",\"anchor\":\"#create-the-tables-of-content-on-the-server-side-with-jsdom\",\"children\":[]},{\"level\":2,\"title\":\"Conclusion\",\"anchor\":\"#conclusion\",\"children\":[]}],\"plain\":[{\"level\":2,\"title\":\"Basic markdown it setup\",\"anchor\":\"#basic-markdown-it-setup\"},{\"level\":2,\"title\":\"Plain table of content\",\"anchor\":\"#plain-table-of-content\"},{\"level\":2,\"title\":\"Tree table of content\",\"anchor\":\"#tree-table-of-content\"},{\"level\":2,\"title\":\"Create the tables of content on the server-side with jsdom\",\"anchor\":\"#create-the-tables-of-content-on-the-server-side-with-jsdom\"},{\"level\":2,\"title\":\"Conclusion\",\"anchor\":\"#conclusion\"}]},\"meta\":{\"id\":2,\"date\":\"2020-09-18T00:00:00.000Z\",\"tweet\":\"1311016921006059527\",\"title\":\"How to create a JSON table of contents with markdown-it and markdown-it-anchor\",\"description\":\"Steps by step guide parse your markdown's HTML at compile stage using node and jsdom with full github repository.\",\"intro\":\"There are some plugins to create a table of content using markdown-it, but sometimes you want to create a custom component for rendering your TOC.\\n\\nHere a simple example on how to get the table of content's tree with vanilla javascript without writing any markdown-it plugin.\\n\\n::: gnome-terminal-image \\\"demo\\\" \\\"https://raw.githubusercontent.com/angelblanco/demo-markdown-it-anchor-toc-jsdom/master/demo.gif\\\"\\n\",\"tags\":[\"js\",\"node\",\"github\"],\"published\":true,\"slug\":\"how-to-create-a-json-toc-with-markdown-it-anchor-using-jsdom\",\"titleSlug\":\"how-to-create-a-json-table-of-contents-with-markdown-it-and-markdown-it-anchor\",\"readingStats\":{\"text\":\"5 min read\",\"minutes\":4.13,\"time\":247800,\"words\":826}},\"html\":\"\u003Ch2 id=\\\"basic-markdown-it-setup\\\" tabindex=\\\"-1\\\">\u003Ca class=\\\"header-anchor\\\" href=\\\"#basic-markdown-it-setup\\\">Basic markdown it setup\u003C/a>\u003C/h2>\\n\u003Cblockquote>\\n\u003Cp>If you want to skip this process and run the demo on your personal computer you can clone the demo repository on Github\u003C/p>\\n\u003Cdiv class=\\\"github-link-container\\\">\u003Ca href=\\\"https://github.com/angelblanco/demo-markdown-it-anchor-toc-jsdom\\\" target=\\\"__blank\\\" class=\\\"button is-medium\\\">\u003Cspan class=\\\"icon\\\">\u003Ci class=\\\"fab fa-github\\\">\u003C/i>\u003C/span>\u003Cspan>Clone the demo of this article on Github\u003C/span>\u003C/a>\u003C/div>\u003C/blockquote>\\n\u003Cp>On your javascript application, we want to install some dependencies first.\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-bash\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">bash\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-bash\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--function\\\">yarn\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">add\u003C/span> --dev markdown-it markdown-it-anchor\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Cp>Now let's convert some simple markdown to Html:\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--comment\\\">// demo.js\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> \u003Cspan class=\\\"hl--token hl--maybe-class-name\\\">MarkdownIt\u003C/span> \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">require\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">'markdown-it'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n\u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> md \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--keyword\\\">new\u003C/span> \u003Cspan class=\\\"hl--token hl--class-name\\\">MarkdownIt\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">use\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--function\\\">require\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">'markdown-it-anchor'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n\u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> markdownText \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--template-string\\\">\u003Cspan class=\\\"hl--token hl--template-punctuation hl--string\\\">`\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">\\n# First header\\nSome content\\n\\n## Second-level header\\nMore content\\n### Third level header\\n## Another second-level header\\n\u003C/span>\u003Cspan class=\\\"hl--token hl--template-punctuation hl--string\\\">`\u003C/span>\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n\u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> html \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> md\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">render\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>markdownText\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n\u003Cspan class=\\\"hl--token hl--console hl--class-name\\\">console\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">log\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span> html \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Ch2 id=\\\"plain-table-of-content\\\" tabindex=\\\"-1\\\">\u003Ca class=\\\"header-anchor\\\" href=\\\"#plain-table-of-content\\\">Plain table of content\u003C/a>\u003C/h2>\\n\u003Cp>The first approach will be to create a plain TOC, that returns a one level array with the title, the anchor, and the associated level. Using this type of TOC could give you a really clear component, avoiding the extra complexity of recursion.\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--keyword\\\">function\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">createPlainToc\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--parameter\\\">domElement\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> headers \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--known-class-name hl--class-name\\\">Array\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--keyword hl--module\\\">from\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\\n    domElement\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">querySelectorAll\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">'h1, h2, h3, h4, h5, h6, h7'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n  \u003Cspan class=\\\"hl--token hl--comment\\\">// This will create a plain array with the level, the anchor and the header title\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">return\u003C/span> headers\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">map\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--parameter\\\">header\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--arrow hl--operator\\\">=>\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">parseInt\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>header\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">tagName\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\u003Cspan class=\\\"hl--token hl--number\\\">1\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">10\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> header\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">textContent\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#'\u003C/span> \u003Cspan class=\\\"hl--token hl--operator\\\">+\u003C/span> header\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">getAttribute\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">'id'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Cp>Using the above markdown text, it will return us the following output:\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">1\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'First header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#first-header'\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">2\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'Second level header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#second-level-header'\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">3\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'Third level header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#third-level-header'\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">2\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'Another second level header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#another-second-level-header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Cblockquote>\\n\u003Cp>Alternatively you can test the above function with this page itself. You can copy the function and run\\nthe following code on the browser's console\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--console hl--class-name\\\">console\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">log\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--known-class-name hl--class-name\\\">JSON\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">stringify\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--function\\\">createPlainToc\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--dom hl--variable\\\">window\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">document\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">querySelector\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">'.articleBody'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003C/blockquote>\\n\u003Ch2 id=\\\"tree-table-of-content\\\" tabindex=\\\"-1\\\">\u003Ca class=\\\"header-anchor\\\" href=\\\"#tree-table-of-content\\\">Tree table of content\u003C/a>\u003C/h2>\\n\u003Cp>Most of the time we will be interested in creating a tree representation of the data.\\nIn this way, we can create a recursive component that runs through the tree. We can reuse our previous function and build the data using a stack and tacking advantage of object references in Javascript. We must perform two validations:\u003C/p>\\n\u003Col>\\n\u003Cli>We force all root nodes to have the same level, but not a minimum one.\u003C/li>\\n\u003Cli>We force all children nodes to have the parent's level + 1.\u003C/li>\\n\u003C/ol>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--keyword\\\">function\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">createTreeToc\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--parameter\\\">domElement\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span> throwOnNotTree \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--boolean\\\">true\u003C/span>\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> treeItems \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">createPlainToc\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>domElement\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">map\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--parameter\\\">item\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--arrow hl--operator\\\">=>\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--spread hl--operator\\\">...\u003C/span>item\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">children\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n  \u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> tree \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> stack \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n  treeItems\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">forEach\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--parameter\\\">item\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--arrow hl--operator\\\">=>\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--keyword\\\">let\u003C/span> parentItem \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--keyword hl--null hl--nil\\\">null\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">do\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n      parentItem \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> stack\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">pop\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span> \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">while\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>parentItem \u003Cspan class=\\\"hl--token hl--operator\\\">&amp;&amp;\u003C/span> parentItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">level\u003C/span> \u003Cspan class=\\\"hl--token hl--operator\\\">>=\u003C/span> item\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n    \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">if\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">!\u003C/span>parentItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--comment\\\">// All nodes in tree[] must have the same level.\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> prevTreeItem \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> tree\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">pop\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">if\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>prevTreeItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">if\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>throwOnNotTree \u003Cspan class=\\\"hl--token hl--operator\\\">&amp;&amp;\u003C/span> item\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">level\u003C/span> \u003Cspan class=\\\"hl--token hl--operator\\\">!==\u003C/span> prevTreeItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n          \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">throw\u003C/span> \u003Cspan class=\\\"hl--token hl--keyword\\\">new\u003C/span> \u003Cspan class=\\\"hl--token hl--class-name\\\">Error\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\\n            \u003Cspan class=\\\"hl--token hl--template-string\\\">\u003Cspan class=\\\"hl--token hl--template-punctuation hl--string\\\">`\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">Root titles dont have same level on: \\\"\u003C/span>\u003Cspan class=\\\"hl--token hl--interpolation\\\">\u003Cspan class=\\\"hl--token hl--interpolation-punctuation hl--punctuation\\\">${\u003C/span>item\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--interpolation-punctuation hl--punctuation\\\">}\u003C/span>\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">\\\"\u003C/span>\u003Cspan class=\\\"hl--token hl--template-punctuation hl--string\\\">`\u003C/span>\u003C/span>\\n          \u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\\n\\n        tree\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">push\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>prevTreeItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\\n\\n      tree\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">push\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>item\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n      stack\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">push\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>item\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span> \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">else\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">if\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>throwOnNotTree \u003Cspan class=\\\"hl--token hl--operator\\\">&amp;&amp;\u003C/span> parentItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">level\u003C/span> \u003Cspan class=\\\"hl--token hl--operator\\\">!==\u003C/span> item\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">level\u003C/span> \u003Cspan class=\\\"hl--token hl--operator\\\">-\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">1\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--comment\\\">// All nodes in tree[] must have the same level.\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">throw\u003C/span> \u003Cspan class=\\\"hl--token hl--keyword\\\">new\u003C/span> \u003Cspan class=\\\"hl--token hl--class-name\\\">Error\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\\n          \u003Cspan class=\\\"hl--token hl--template-string\\\">\u003Cspan class=\\\"hl--token hl--template-punctuation hl--string\\\">`\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">The title \\\"\u003C/span>\u003Cspan class=\\\"hl--token hl--interpolation\\\">\u003Cspan class=\\\"hl--token hl--interpolation-punctuation hl--punctuation\\\">${\u003C/span>item\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--interpolation-punctuation hl--punctuation\\\">}\u003C/span>\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">\\\" is not a direct children of its parent\u003C/span>\u003Cspan class=\\\"hl--token hl--template-punctuation hl--string\\\">`\u003C/span>\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\\n\\n      stack\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">push\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>parentItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n      stack\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">push\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>item\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n      parentItem\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">children\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">push\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>item\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n  \u003Cspan class=\\\"hl--token hl--keyword hl--control-flow\\\">return\u003C/span> tree\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Cp>Using the previous markdown we will have a well-defined tree for each top-level header and their associated children.\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">1\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'First header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#first-header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">children\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">2\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'Second level header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#second-level-header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">children\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\\n          \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n            \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">3\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n            \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'Third level header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n            \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#third-level-header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n            \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">children\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n          \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--punctuation\\\">{\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">level\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--number\\\">2\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">title\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'Another second level header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">anchor\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--string\\\">'#another-second-level-header'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n        \u003Cspan class=\\\"hl--token hl--literal-property hl--property\\\">children\u003C/span>\u003Cspan class=\\\"hl--token hl--operator\\\">:\u003C/span> \u003Cspan class=\\\"hl--token hl--punctuation\\\">[\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n      \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n    \u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--punctuation\\\">}\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">,\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--punctuation\\\">]\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Cp>Of course opening the dev tools you can paste the previous functions, an test it with this page!\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--console hl--class-name\\\">console\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">log\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\\n  \u003Cspan class=\\\"hl--token hl--known-class-name hl--class-name\\\">JSON\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">stringify\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--function\\\">createTreeToc\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--dom hl--variable\\\">window\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">document\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">querySelector\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--string\\\">'.articleBody'\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Ch2 id=\\\"create-the-tables-of-content-on-the-server-side-with-jsdom\\\" tabindex=\\\"-1\\\">\u003Ca class=\\\"header-anchor\\\" href=\\\"#create-the-tables-of-content-on-the-server-side-with-jsdom\\\">Create the tables of content on the server-side with jsdom\u003C/a>\u003C/h2>\\n\u003Cp>If you want to create the TOC on your node server or at the moment of compiling your markdown files, we can reuse our functions by installing \u003Ca href=\\\"https://github.com/jsdom/jsdom\\\" target=\\\"_blank\\\">jsdom\u003C/a>.\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-bash\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">bash\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-bash\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--function\\\">yarn\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">add\u003C/span> --dev jsdom\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Cp>As the Html will be the hole markdown file we can create the table of content for the whole \u003Ccode>window.document\u003C/code>.\u003C/p>\\n\u003Cpre class=\\\"terminal\\\">\\n  \u003Cdiv class=\\\"bar bar-language-javascript\\\">\\n    \u003Cdiv class=\\\"btn\\\">\u003C/div>\\n    \u003Cdiv class=\\\"bar-title\\\">javascript\u003C/div>\\n    \u003Cdiv>\u003Cbutton class=\\\"button copy is-small is-pulled-right\\\">Copy\u003C/button>\u003C/div>  \\n  \u003C/div>\\n  \u003Cdiv class=\\\"body\\\">\u003Cpre class=\\\"language-javascript\\\">\u003Ccode>\u003Cspan class=\\\"hl--token hl--comment\\\">// Asuming that html is the rendered markdown with html and nothing else.\u003C/span>\\n\u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> domElement \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--keyword\\\">new\u003C/span> \u003Cspan class=\\\"hl--token hl--class-name\\\">jsdom\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>JSDOM\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>html\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">window\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--property-access\\\">document\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n\u003Cspan class=\\\"hl--token hl--keyword\\\">const\u003C/span> toc \u003Cspan class=\\\"hl--token hl--operator\\\">=\u003C/span> \u003Cspan class=\\\"hl--token hl--function\\\">createTreeToc\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>domElement\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\\n\u003Cspan class=\\\"hl--token hl--console hl--class-name\\\">console\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">log\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>\u003Cspan class=\\\"hl--token hl--known-class-name hl--class-name\\\">JSON\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">.\u003C/span>\u003Cspan class=\\\"hl--token hl--method hl--function hl--property-access\\\">stringify\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">(\u003C/span>toc\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">)\u003C/span>\u003Cspan class=\\\"hl--token hl--punctuation\\\">;\u003C/span>\\n\u003C/code>\u003C/pre>\u003C/div>\\n  \u003C/pre>\\n\u003Cp>Using this last approach its how I set up a simple demo on Github.\u003C/p>\\n\u003Cdiv class=\\\"github-link-container\\\">\u003Ca href=\\\"https://github.com/angelblanco/demo-markdown-it-anchor-toc-jsdom\\\" target=\\\"__blank\\\" class=\\\"button is-medium\\\">\u003Cspan class=\\\"icon\\\">\u003Ci class=\\\"fab fa-github\\\">\u003C/i>\u003C/span>\u003Cspan>Clone the demo of this article on Github\u003C/span>\u003C/a>\u003C/div>\u003Ch2 id=\\\"conclusion\\\" tabindex=\\\"-1\\\">\u003Ca class=\\\"header-anchor\\\" href=\\\"#conclusion\\\">Conclusion\u003C/a>\u003C/h2>\\n\u003Cp>Using \u003Ccode>jsdom\u003C/code> to parse the whole HTML file to get the table of content might look like an overhead. However, doing this stuff at\\nyour javascript compile stage will get you the fastest loading times for your web because it could be server-side rendered. On the other hand,\\nif you parse your TOC in the browser you could access all the DOM elements on the web and not only the markdown ones.\u003C/p>\\n\u003Cp>Thank you very much for your time. Hope to see you again 泅\u003C/p>\\n\"}"}</script>
  </body>
</html>
